{"hash":"390d302cd552305fd677e06bbdca7834a7d72d7b","data":{"post":{"title":"How to integrate Infinite Loading with Gridsome","date":"8. October 2019","timeToRead":3,"content":"<h2 id=\"what-is-infinite-loading-why-should-i-use-it\"><a href=\"#what-is-infinite-loading-why-should-i-use-it\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>What is infinite loading? Why should I use it?</h2>\n<p>Paginating data in Gridsome is easy using the built-in <a href=\"/docs/pagination/\">@paginate directive</a> and even includes a custom <a href=\"/docs/pagination/#pager-component\">pager component</a>.</p>\n<p>Infinite loading provides the same performance as traditional paginatation without requiring any extra navigational UI to be included in a page.</p>\n<p>You can check out a full working example here: <a href=\"https://gridsome-infinite-loading.netlify.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://gridsome-infinite-loading.netlify.com</a></p>\n<h2 id=\"install-the-required-dependencies\"><a href=\"#install-the-required-dependencies\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Install the required dependencies</h2>\n<p>There are many packages that implement the infinite loading technique but one that works particularly well with Gridsome is <a href=\"https://github.com//PeachScript/vue-infinite-loading\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">vue-infinite-loading</a>. To add it to your Gridsome project, <code class=\"language-text\">cd</code> into your project's root and run the following:</p>\n<p><code class=\"language-text\">yarn add vue-infinite-loading</code></p>\n<h2 id=\"setup\"><a href=\"#setup\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Setup</h2>\n<p>To use <code class=\"language-text\">vue-infinite-loading</code> you'll need to add it to your <code class=\"language-text\">main.js</code> file first:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword module\">import</span> <span class=\"token maybe-class-name\">InfiniteLoading</span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'vue-infinite-loading'</span>\n\n<span class=\"token keyword module\">export</span> <span class=\"token keyword module\">default</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token maybe-class-name\">Vue</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> router<span class=\"token punctuation\">,</span> head<span class=\"token punctuation\">,</span> isClient <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token maybe-class-name\">Vue</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">use</span><span class=\"token punctuation\">(</span><span class=\"token maybe-class-name\">InfiniteLoading</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<h2 id=\"blog-example\"><a href=\"#blog-example\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Blog Example</h2>\n<p>To demonstrate how to use <code class=\"language-text\">vue-infinite-loading</code> let's assume a pretty typical BlogPost type.</p>\n<h3 id=\"page-query\"><a href=\"#page-query\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a><code class=\"language-text\">&lt;page-query&gt;</code></h3>\n<p>Your paginated <code class=\"language-text\">&lt;page-query&gt;</code> would look something like this:</p>\n<pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token keyword\">query</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$page</span><span class=\"token punctuation\">:</span> Int<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token attr-name\">posts</span><span class=\"token punctuation\">:</span> allBlogPost<span class=\"token punctuation\">(</span><span class=\"token attr-name\">perPage</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">page</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$page</span><span class=\"token punctuation\">)</span> <span class=\"token directive function\">@paginate</span> <span class=\"token punctuation\">{</span>\n\t\tpageInfo <span class=\"token punctuation\">{</span>\n\t\t\ttotalPages\n\t\t\tcurrentPage\n\t\t<span class=\"token punctuation\">}</span>\n\t\tedges <span class=\"token punctuation\">{</span>\n\t\t\tnode <span class=\"token punctuation\">{</span>\n\t\t\t\tid\n\t\t\t\ttitle\n\t\t\t\tpath\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>This is a pretty typical way to do traditional pagintation, but we're not going to include a pager component in the UI.</p>\n<h3 id=\"script\"><a href=\"#script\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a><code class=\"language-text\">&lt;script&gt;</code></h3>\n<p>Next, we'll need to add a few things to our <code class=\"language-text\">&lt;script&gt;</code> tag:</p>\n<ol>\n<li>A couple of variables in our <code class=\"language-text\">data()</code> method to keep track of our <code class=\"language-text\">loadedPosts</code> as well as the <code class=\"language-text\">currentPage</code>.</li>\n<li>Some code to the created method to add the initial \"page\" of data to our <code class=\"language-text\">loadedPosts</code> array.</li>\n<li>A handler method to pass to our <code class=\"language-text\">vue-infinite-loading</code> component so it knows how to load the next batch of data.</li>\n</ol>\n<p>Here's what that would look like:</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// component for displaying our individual blog post previews</span>\n<span class=\"token keyword module\">import</span> <span class=\"token maybe-class-name\">PostCard</span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'~/components/PostCard.vue'</span>\n\n<span class=\"token keyword module\">export</span> <span class=\"token keyword module\">default</span> <span class=\"token punctuation\">{</span>\n\tcomponents<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token maybe-class-name\">PostCard</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n\t\t\tloadedPosts<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\t\t\tcurrentPage<span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token function\">created</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">loadedPosts</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span><span class=\"token spread operator\">...</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">$page</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">posts</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">edges</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\tmethods<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">async</span> <span class=\"token function\">infiniteHandler</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">$state</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">currentPage</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span> <span class=\"token operator\">></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">$page</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">posts</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">pageInfo</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">totalPages</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t$state<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">complete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">$fetch</span><span class=\"token punctuation\">(</span>\n\t\t\t\t\t<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/blog/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">currentPage</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n\t\t\t\t<span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span><span class=\"token property-access\">posts</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">edges</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">currentPage</span> <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span><span class=\"token property-access\">posts</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">pageInfo</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">currentPage</span>\n\t\t\t\t\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">loadedPosts</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span><span class=\"token spread operator\">...</span>data<span class=\"token punctuation\">.</span><span class=\"token property-access\">posts</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">edges</span><span class=\"token punctuation\">)</span>\n\t\t\t\t\t$state<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">loaded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t$state<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">complete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Note that you will have to update the path used in the <code class=\"language-text\">this.$fetch()</code> line to match the path of the page we're building.</p>\n<h3 id=\"template\"><a href=\"#template\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a><code class=\"language-text\">&lt;template&gt;</code></h3>\n<p>Now for the template. One important thing to remember here is that we're going to be iterating over our <code class=\"language-text\">loadedPosts</code> array rather than the page query object directly.</p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Layout</span><span class=\"token punctuation\">></span></span>\n\t\t<span class=\"token comment\">&lt;!-- List blog posts --></span>\n\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>posts<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>transition-group</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>fade<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\t\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>PostCard</span>\n\t\t\t\t\t<span class=\"token attr-name\">v-for</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{ node } of loadedPosts<span class=\"token punctuation\">\"</span></span>\n\t\t\t\t\t<span class=\"token attr-name\">:key</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>node.id<span class=\"token punctuation\">\"</span></span>\n\t\t\t\t\t<span class=\"token attr-name\">:post</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>node<span class=\"token punctuation\">\"</span></span>\n\t\t\t\t<span class=\"token punctuation\">/></span></span>\n\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>transition-group</span><span class=\"token punctuation\">></span></span>\n\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ClientOnly</span><span class=\"token punctuation\">></span></span>\n\t\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>infinite-loading</span> <span class=\"token attr-name\">@infinite</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>infiniteHandler<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">spinner</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>spiral<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\t\t\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">slot</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>no-more<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\t\t\t\t\t\tYou've scrolled through all the posts ;)\n\t\t\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n\t\t\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">slot</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>no-results<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\t\t\t\t\t\tSorry, no posts yet :(\n\t\t\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n\t\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>infinite-loading</span><span class=\"token punctuation\">></span></span>\n\t\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ClientOnly</span><span class=\"token punctuation\">></span></span>\n\t\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n\t<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Layout</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">></span></span></code></pre>\n<p>We've wrapped our <code class=\"language-text\">&lt;infinite-loading&gt;</code> component in Gridsome's <code class=\"language-text\">&lt;ClientOnly&gt;</code> tag to ensure this works correctly in the production build as well as local development.</p>\n<p>The slots included in the <code class=\"language-text\">&lt;infinite-loading&gt;</code> component as well as the <code class=\"language-text\">spinner</code> prop are optional. You can read more about those in the <a href=\"https://peachscript.github.io/vue-infinite-loading/api/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">API docs</a> for <code class=\"language-text\">vue-infinite-loading</code>.</p>\n<h2 id=\"transitions\"><a href=\"#transitions\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Transitions</h2>\n<p>As you can see we've wrapped our blog post component in a <code class=\"language-text\">&lt;transition-group&gt;</code> with the name <code class=\"language-text\">fade</code>. This is so that we can style the transition animation on posts fetched by <code class=\"language-text\">vue-infinite-loading</code>. To implement a simple fade-in animation add the following styles to your CSS somewhere:</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\"><span class=\"token class\">.fade-enter-active</span>,\n<span class=\"token class\">.fade-leave-active</span></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> ease opacity <span class=\"token number\">0.3</span><span class=\"token unit\">s</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\"><span class=\"token class\">.fade-enter</span>,\n<span class=\"token class\">.fade-leave-to</span></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token property\">opacity</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<h2 id=\"conclusion\"><a href=\"#conclusion\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Conclusion</h2>\n<p>As you can see, implementing the infinite loading technique in Gridsome is trivial thanks to the <code class=\"language-text\">vue-infinite-loading</code> plugin and Gridsome's built-in <a href=\"/docs/pagination/\">pagination system</a> and <a href=\"/docs/client-side-data/#fetch-from-internal-pages\">fetch</a> method.</p>\n<p>With that...</p>\n<p><code class=\"language-text\">You&#39;ve scrolled to the end ;)</code></p>\n","author":[],"excerpt":"Infinite loading is an alternative strategy for loading additional nodes/content onto a page without the use of traditional pagination. Infinite loading instead loads the next batch of content when a user scrolls to the bottom of a web page."}},"context":{}}